<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>GPS Notepad</title>
	<meta name="viewport" content="width=device-width">
	<!-- Resource Information -->
	<link rel="stylesheet" type="text/css" href=gpsNotepad.css>
	<script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/jquery-1.11.0.js"></script>
	<script type="text/javascript" src="js/gpsNotepad.js"></script>
	<script type="text/javascript" >
		//
		// Wait for everthing to load
		//
		document.addEventListener("deviceready", onDeviceReady, false);

		//
		// Cordova is ready
		//
		// NOTE: The initialTimeOut is to wait for the GPS to get a decent reading.
		// NOTE: This need to be in the same scope as the EventListener. 
		//	It canNOT go in a seperate file.
		var dummyLoader = function() {
			getLocation();
		}
		function onDeviceReady() {
			//window.setTimeout(dummyLoader, initialTimeOut);
		}


		function handleUpload() {
			blockUI = 1;
			if (collectRunning) {
				handleStopB();
			}
    	   	document.getElementById('status').innerHTML = 'Uploading ...';
			//
			//
			//gpsUpload(ourCallBackFunc, ourErrorFunc, OurServer, OurUser, GPSKeeperStack);
		}

		var ourCallBackFunc = function(){
			blockUI = 0;
			//GPSKeeperStack = Array();
			alert("Data Away.");
			if (collectRunning) {
				handleStartB();
			}
		}

		var ourErrorFunc = function(){
			alert("We got an error!");
			if (collectRunning) {
				handleStartB();
			}
		}

		function handleStartB() {
			if ( ! blockUI ){
				collectRunning = 1;
		       	document.getElementById('status').innerHTML = 'Starting ...';
				watchLocation();
	    	   	document.getElementById('status').innerHTML = 'Running ...';
			}
		}

		function handleStopB() {
			if ( ! blockUI ){
				collectRunning = 0;
		       	document.getElementById('status').innerHTML = 'Stopped ...';
				clearWatch();
			}
		}
	</script>

</head>
<body>
	<center>
	<div class=default>
		<p id='debugger'>Finding geolocation...</p>
	</div>
	<div class='status'>
		<span id=status>Status</span>
		<span id=counter style=float:right;></span>
	</div>

	<div id=uploadButton onclick="handleUpload()">Upload Readings</div>
	<div id=runButtons class=defaultOff>
		<span id=stopButton onclick="handleStopB()">Stop</span>
		<span id=startButton onclick="handleStartB()">Start</span>
	</div>
	<br style=clear:both;>
	<div id=mainPanel>
		<div id=recentReading><span id=latLong>Lat,Long</span></div>
		<div id=gpsNotepad>GPSNotepad</div>
		<div id=debug></div>
	</div>
	</center>

</body>
</html>
