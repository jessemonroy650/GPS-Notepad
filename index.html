<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>GPS Notepad</title>
	<meta name="viewport" content="width=device-width">
	<!-- Resource Information -->
	<link rel="stylesheet" type="text/css" href=css/buttons.css>
	<link rel="stylesheet" type="text/css" href=css/gpsNotepad.css>
	<link rel="stylesheet" type="text/css" href=css/sliding-window.css>
	<link rel="stylesheet" type="text/css" href=css/messages.css>
	<!-- <link rel="stylesheet" type="text/css" href=css/config.css> -->

    <!-- message.js toggles a "growl" and is tied to config.css & login.css -->
	<script type="text/javascript" src="js/messages.js"></script>
    <script type="text/javascript" src='js/firebase-2.0.5.js'></script>
	<script type="text/javascript" src="js/jquery-1.11.0.js"></script>
	<script type="text/javascript" src="js/gpsNotepad.js"></script>
	<script type="text/javascript" src="gpsNotepad-firebase.js"></script>
	<script type="text/javascript" src="gpsNotepad-firebase-user.js"></script>
	<script type="text/javascript" src="gpsNotepad-firebase-anon.js"></script>
	<script type="text/javascript" src="cordova.js"></script>

	<script type="text/javascript" >
	</script>
  </head>
<body onload="onDeviceReady()">
	<center>
	<div id=header class=header>
		<img id=menubar src=images/3menubars_lightgrey.png>
		<img id=app_icon src=res/drawable-mdpi/icon.png>
		<span id=app_title>GPS Notepad
			<span id=version></span>
		</span>
	</div>
	<div id=config class="config">
		units in meter <input name=accuracy_type type=radio value="meter" checked=checked>
               or feet <input name=accuracy_type type=radio value="feet">
		<hr style=width:50%;margin:0.5em;>
		details all <input name=details_type type=radio value="all" checked=checked>
		   or short <input name=details_type type=radio value="short">
		<hr style=width:50%;margin:0.5em;>
		accuracy <input id=accuracyNumber type=text size=1>
	</div>
	<div id=login class="login">
		<h2>Login</h2>
		<input type=text id=email placeholder=email><br>
		<input type=text id=password placeholder=password><br>
		<button type=button id=loginButton>Login</button>
	</div>
	<div class=default>
		<div id=gpsDetails>Finding geolocation...</div>
	</div>
	<div class='wrapper_status'>
		<span id=status>Status</span>
		<span id=counter style=float:right;></span>
	</div>

	<div id=runButtons class=defaultOff>
		<span id=stopButton class="button button-rounded button-caution">Stop</span>
		<span id=notepadButton class="button button-rounded button-action">Notepad</span>
		<span id=startButton class="button button-rounded button-primary">Start</span>
	</div>
	<br style=clear:both;>
	<div id=mainPanel>
		<div id=recentReading>
			<span id=latLong>Lat,Long</span>
			<img id=copypaste src=images/editpaste_24x24.png/>
		</div>
		<div id=gpsNotepad>GPSNotepad</div>
		<div id=debug></div>
	</div>
	</center>

</body>
<script type="text/javascript" >
	//
	// Wait for everthing to load
	// "deviceready" is only available on phonegap
	//document.addEventListener("deviceready", onDeviceReady, false);

	//
	// Cordova is ready
	//
	// NOTE: The initialTimeOut is to wait for the GPS to get a decent reading.
	// NOTE: This need to be in the same scope as the EventListener. 
	//	It canNOT go in a seperate file.
	var dummyLoader = function() {
		Location.getLocation();
	}
	function onDeviceReady() {
		//window.setTimeout(dummyLoader, initialTimeOut);
		$('#status').html("Device Ready.");
		console.log("device ready");
		Location.init(GPSonSuccess, GPSonError);
		// Vibrate on ready.		
		navigator.vibrate([500, 1000, 500, 1000, 500]);

		$('#app_icon').click(function(){
			console.log('#app_icon');
			myMessage.Toggle('login');
		});
		//
		//	Toggle the configuration screen & update the values
		//
		$('#menubar').click(function(){
			console.log('#menubar');
			// http://stackoverflow.com/questions/5665915/how-to-check-a-radio-button-with-jquery
			$('input[name=details_type][value=' + typeDetails + ']').prop('checked', 'checked');
			$('input[name=accuracy_type][value=' + typeAccuracy + ']').prop('checked', 'checked');
			$('#accuracyNumber').val(minimumAccuracy);
			myMessage.Toggle('config');
		});

		//
		//	Start, Stop, Upload, Singleshot reading
		//
		$('#notepadButton').click(function() {
			$('#status').html("Uploading ...").removeClass().addClass("button-action");
        });

		$('#startButton').click(function() {
			$('#status').html("Starting ... ").removeClass();
			Location.watchLocation();
			$('#status').html("Running ...  ").addClass("button-primary");
       	});

		$('#stopButton').click(function() {
			$('#status').html("Stopped ...  ").removeClass().addClass("button-caution");
			Location.clearWatch();
   	    });

		//
		$('#copypaste').click(function() {
			console.log("got #copypaste:" + GPSKeeperLastReading);
		});

		//
		//	Save the configuration values
		//
		$('input[name=details_type]').click(function() {
			console.log("got input[name=details_type]" + this.getAttribute("value"));
			typeDetails = this.getAttribute("value");
   	    });

		$('input[name=accuracy_type]').click(function() {
			console.log("got input[name=accuracy_type]" + this.getAttribute("value"));
			typeAccuracy = this.getAttribute("value");
   	    });

        $('#accuracyNumber').change(function() {
			//console.log($('#accuracyNumber').val());
			minimumAccuracy = $('#accuracyNumber').val(); // this.val();
		});
	}

	function onServiceError(code) {
		switch (code) {
			case PositionError.PERMISSION_DENIED:
			break;
			case PositionError.POSITION_UNAVAILABLE:
				$('#status').html("Location service UNAVAILABLE.").removeClass().addClass("button-highlight");
			break;
			case PositionError.TIMEOUT:
				$('#status').html("Location service timed out.").removeClass().addClass("button-caution");
			break;
			default:
		}
	}

</script>
</html>
